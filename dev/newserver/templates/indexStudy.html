{% extends "base.html" %}

{% block body %}
<div id="browseralert">
  Please log in using a laptop or a desktop computer for the best Immersion experience.
  <br>
  Thanks!
</div>
<div id="box">
  <div style="margin: 0 auto 0 auto; width: 350px;">
      <a id="login_handler1" style="text-decoration: none;">
        <div id="landing_circle">immersion</div>
      </a>
  </div>
  <div id="landing_tagline_box">
    <div id="tagline">a people-centric view of your email life</div>
  </div>
  <div id="landing_privacy">
    <div class="privacy_pillar">
      <div class="pillar_point">By logging in, you are accepting to participate in the study <b>{{ study['name'] }}</b>. For any questions regarding the study, email <b>{{ study['email'] }}</b>.</div>
      <br/>
      <div class="pillar_point">Study description: <b>{{ study['description'] }}</b>
      </div>
    </div>
    <div class="privacy_pillar">
      <div class="pillar_point">Once you log in, Immersion will use only the From, To, Cc and Timestamp fields of the emails in the account you are signing in with. It will not access the subject or the body content of any of your emails.
      </div>
      <br/>
      <div class="pillar_point">If you take a snapshot of your Immersion network, the snapshot link will be accessible for 30 days, after which it will be deleted from our server.</div><br>
      
    </div>
    <div class="privacy_pillar">
      <!-- <div class="pillar_point">Immersion currently supports only Gmail accounts, and login is done <b>securely</b> using OAuth via Gmail, without revealing your password to Immersion.</div><br/> -->
      <div id="yahoo_loginform" class="form" style="display:none;border-left: 5px solid black;padding-left:5px;margin-bottom:10px">
        <form action="/authyahoo" method="post" onsubmit="return validateForm(this)">
          <table>
            <tr>
              <td>Email:</td>
              <td><input type="text" name="email" value="{{form_email}}"></td>
            </tr>
            <tr>
              <td>Password:</td>
              <td><input type="password" name="password"></td>
            </tr>
            <tr>
              <td><input type="submit" value="Login"></td>
              <td class="invalid_input_msg" style="color:red; display:none;">Invalid email/password</td>
            </tr>
          </table>
        </form>
      </div>

      <div id="ews_loginform" class="form" style="display:none;border-left: 5px solid black;padding-left:5px;margin-bottom:10px">
        <form action="/authews" method="post" onsubmit="return validateForm(this)">
          <table>
            <tr>
              <td colspan="2" style="font-weight:bold;font-size:12px;color:DarkRed;">Use this if your organization's email is running on Microsoft Exchange Server. @hotmail.com, @live.com and @outlook.com are not supported at the moment.</td>
            </tr>
            <tr>
              <td>Email:</td>
              <td><input type="text" name="email" value="{{form_email}}"></td>
            </tr>
            <tr>
              <td>Username:</td>
              <td><input type="text" name="username" value="{{form_username}}"></td>
            </tr>
            <tr>
              <td>Password:</td>
              <td><input type="password" name="password"></td>
            </tr>
            <tr>
              <td><input type="submit" value="Login"></td>
              <td class="invalid_input_msg" style="color:red; display:none;">Invalid username/password</td>
            </tr>
          </table>
        </form>
      </div>
      <div><b>Login securely via</b></div>
      <div style="height:80px; width:280px">
        <a id="login_handler2" class="landing_login" style="float:left;">Gmail</a> 
        <a id="login_exchange" class="landing_login" style="float:left;">MS Exchange</a>
        <a id="login_yahoo" class="landing_login" style="float:left;">Yahoo</a>
      </div>
    </div>
    <br style="clear: both;" />
  </div>
  <div style="background-color: white;">
    <div class="landing_slab">
      <div class="landing_header">What is Immersion?</div>
      <div id="about_inner">
        <div class="about_child">It has been almost two decades since the beginning of the web. This means that the web is no longer just a technology of the present, but also, a record of our past. <br><br> Email, one of the original forms of social media, is even older than the web and contains a detailed description of our personal and professional history.</div>
        <div class="about_child" style="border-left: 5px solid black; padding-left: 10px;"><b>Immersion</b> is an invitation to dive into the history of your email life in a platform that offers you the safety of knowing that you can always delete your data.</div>
        <div class="about_child" style="border-left: 5px solid black; padding-left: 10px;">Just like a cubist painting, Immersion presents users with a number of different perspectives of their email data. <br>It provides a tool for self-reflection at a time where the zeitgeist is one of self-promotion. <br>It provides an artistic representation that exists only in the presence of the visitor. <br>It helps explore privacy by showing users data that they have already shared with others. <br>Finally, it presents users wanting to be more strategic with their professional interactions, with a map to plan more effectively who they connect with.</div>
        <div class="about_child">So Immersion is not about one thing. It’s about four. It’s about <b>self-reflection, art, privacy</b> and <b>strategy</b>. It’s about providing users with a number of different perspectives by leveraging on the fact that the web, and emails, are now an important part of our past.</div>
      </div>
    </div>
    <br style="clear: both;" />
  </div>
  <div class="landing_slab">
    <br style="clear: both;" />
    <div style="margin-bottom: 30px;"> You can reach us via email:<br><b>immersion </b>@ <b>media </b>[dot] <b>mit </b>[dot] <b>edu</b></div>
    </div>
    <div id="footer">
      <div id="signoff">&copy; 2013 <a href="http://macroconnections.media.mit.edu">Macro Connections</a>&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;&nbsp;<a href="http://media.mit.edu">MIT Media Lab</a></div>
    </div>
</div>

<script type="text/javascript">
  function validateEmail(email) { 
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email);
} 

  function validateForm(form) {
    var email = $(form).find("input[name='email']").val();
    var username = $(form).find("input[name='username']").val();
    var password = $(form).find("input[name='password']").val();
    if(validateEmail(email) && password.trim() !== '' && username.trim() !== '') {
      return true;
    } else {
      $(".invalid_input_msg").show();
      return false;
    }
  }


  $('#faqs').click(function () {
      $('body,html').animate({
        scrollTop: $("#faqs_section").offset().top
      }, 1000, 'easeOutExpo');
      return false;
    });

  $('#gototop a').click(function () {
      $('body,html').animate({
        scrollTop: 0
      }, 1000, 'easeOutExpo');
      return false;
    });

  var colors = ['#ff7f0e', '#2ca02c' ,'#d62728' ,'#9467bd', '#17becf'];
  var randnum = Math.floor(Math.random()*colors.length);
  $('#landing_circle').css('background-color', colors[randnum]);


  $("#browseralert").hide();
  var prefix = window.document.location.protocol + '//' + window.document.location.host + "/oauth2callback";
  var authurl = 'https://accounts.google.com/o/oauth2/auth?scope=https%3A%2F%2Fmail.google.com%2F+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile&redirect_uri=' + prefix + "&response_type=code&client_id=xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com&access_type=offline";

  $("#login_exchange").click(function() {
    $( ".form" ).hide();
    $( "#ews_loginform" ).effect("highlight");
    var email_input = $("input[name='email']");
    var pass_input = $("input[name='password']");
    if (email_input.attr("value") === "") {
      email_input.focus();
    } else {
      pass_input.focus();
    }
  });

  $("#login_yahoo").click(function() {
    $( ".form" ).hide();
    $( "#yahoo_loginform" ).effect("highlight");
    var email_input = $("input[name='email']");
    var pass_input = $("input[name='password']");
    if (email_input.attr("value") === "") {
      email_input.focus();
    } else {
      pass_input.focus();
    }
  });

  $("#login_handler2").click(function() {
    if(!isMobile()) window.location = authurl.replace(/&amp;/g, '&')
    else {
      $("#browseralert").fadeIn('fast');
    }
  });

  function isMobile() {
    var check = false;
    (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);
    return check;
  }
</script>

{% end %}
